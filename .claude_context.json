{
  "checkpoint_date": "2026-01-15",
  "project": {
    "name": "scp-lint",
    "description": "Standalone Python CLI tool to lint AWS Service Control Policies for errors, warnings, and best practices",
    "tagline": "Validate SCPs before they break your AWS accounts",
    "version": "0.1.0",
    "author": "OnticX",
    "license": "MIT",
    "pypi_name": "scp-lint",
    "repository": "https://github.com/OnticX/scp-lint"
  },
  "rules": {
    "ascii_only": "Always use ASCII-safe characters in code and output (no unicode symbols like checkmarks)",
    "lint_after_code": "Always run Ruff and mypy after writing Python code"
  },
  "current_state": {
    "branch": "main",
    "test_count": 58,
    "tests_passing": true,
    "pypi_published": true,
    "status": "Published to PyPI"
  },
  "architecture": {
    "overview": "Python CLI tool that validates AWS SCP JSON files against IAM reference data",
    "entry_points": {
      "cli_wrapper": "cli.py - simple wrapper that imports from linter.cli (for local dev/CI)",
      "package_cli": "linter/cli.py - actual CLI implementation (used by pip install)",
      "entry_point": "scp-lint = linter.cli:main"
    },
    "key_modules": {
      "linter/cli.py": "CLI implementation - handles file/directory input, output formatting, exit codes",
      "linter/scp_linter.py": "Main SCPLinter class with 27 lint rules",
      "linter/__init__.py": "Exports LintResult, LintSeverity, SCPLinter",
      "data/iam_reference.py": "AWSIAMReference class that loads and queries the IAM actions database",
      "data/aws_iam_reference.json": "Reference database of 20,000+ AWS IAM actions, services, and condition keys",
      "data/__init__.py": "Exports AWSIAMReference and related classes"
    }
  },
  "structure": {
    "linter": {
      "cli": "linter/cli.py",
      "core": "linter/scp_linter.py",
      "init": "linter/__init__.py"
    },
    "data": {
      "iam_reference": "data/iam_reference.py",
      "aws_iam_reference_json": "data/aws_iam_reference.json",
      "init": "data/__init__.py"
    },
    "tests": "test_linter/test_scp_linter.py",
    "config": {
      "pyproject": "pyproject.toml",
      "requirements": "requirements.txt",
      "manifest": "MANIFEST.in",
      "gitignore": ".gitignore"
    },
    "ci": ".github/workflows/lint.yml"
  },
  "cli_usage": {
    "local_single_file": "python cli.py policy.json",
    "local_directory": "python cli.py ./policies/",
    "installed": "scp-lint policy.json"
  },
  "lint_rules": {
    "total": 27,
    "errors": {
      "E001": "File not found",
      "E002": "Cannot read file",
      "E003": "Invalid JSON syntax",
      "E010": "Policy exceeds 5120 character limit",
      "E020": "Missing Version field",
      "E021": "Missing Statement field",
      "E022": "Statement is not an object or array",
      "E030": "Statement is not an object",
      "E031": "Missing Effect field",
      "E032": "Invalid Effect value (must be Allow or Deny)",
      "E033": "Missing Action or NotAction field",
      "E034": "Principal/NotPrincipal not allowed in SCPs",
      "E040": "Action must be string or array",
      "E041": "Action array item is not a string",
      "E050": "Condition block must be an object",
      "E051": "Condition operator value must be an object",
      "E052": "Unknown condition operator"
    },
    "warnings": {
      "W010": "Policy is over 75% of size limit",
      "W020": "Unusual Version value",
      "W021": "Unknown top-level field",
      "W030": "Empty statements array",
      "W031": "More than 20 statements",
      "W032": "Unknown statement field",
      "W040": "Action missing service prefix",
      "W041": "Unknown service prefix",
      "W042": "Unknown action name (with suggestions)",
      "W043": "Unknown condition key",
      "W044": "Empty condition block",
      "W045": "Empty condition operator block",
      "W046": "Empty or null condition value",
      "W050": "Blanket Deny * without conditions",
      "W051": "Service-wide deny without conditions"
    },
    "info": {
      "I030": "No Resource specified (defaults to *)",
      "I031": "No Sid specified",
      "I050": "Policy contains only Allow statements"
    }
  },
  "iam_reference_data": {
    "source": "iann0036/iam-dataset",
    "stats": {
      "services": 442,
      "actions": 20291,
      "resources": 2147,
      "service_condition_keys": 1352,
      "global_condition_keys": 3
    }
  },
  "testing": {
    "framework": "pytest",
    "test_directory": "test_linter/",
    "test_file": "test_linter/test_scp_linter.py",
    "run_command": "pytest",
    "total_tests": 58
  },
  "packaging": {
    "build_system": "setuptools",
    "config_file": "pyproject.toml",
    "python_requires": ">=3.10",
    "license_format": "SPDX (license = \"MIT\")",
    "dependencies": [
      "boto3>=1.34.0",
      "click>=8.1.0",
      "rich>=13.7.0",
      "python-dateutil>=2.8.0"
    ],
    "dev_dependencies": [
      "pytest>=7.4.0",
      "pytest-mock>=3.11.0",
      "ruff>=0.1.0",
      "mypy>=1.0.0"
    ]
  },
  "run_commands": {
    "tests": "pytest",
    "cli_local": "python cli.py .",
    "install_dev": "pip install -e \".[dev]\"",
    "build": "python -m build",
    "publish_test": "twine upload --repository testpypi dist/*",
    "publish": "twine upload dist/*"
  },
  "github_actions": {
    "workflow_file": ".github/workflows/lint.yml",
    "triggers": ["push to main", "pull_request to main"],
    "python_version": "3.11",
    "steps": [
      "Install dependencies with pip install -e '.[dev]'",
      "Run pytest",
      "Run scp-lint on entire directory (python cli.py .)"
    ]
  },
  "conventions": {
    "imports": "Use 'from linter import SCPLinter, LintResult, LintSeverity'",
    "error_codes": "E-codes are errors (invalid), W-codes are warnings (valid but problematic), I-codes are info (best practices)",
    "scp_detection": "A valid SCP has both 'Version' and 'Statement' keys in the root object"
  },
  "future_enhancements": [
    "Resource ARN format validation",
    "Duplicate Sid detection",
    "Duplicate statement detection",
    "NotAction/NotResource warnings",
    "IP address format validation for IpAddress operator"
  ]
}
